# 자바스크립트 비동기 정리

## Day11번 정리

- 실행과정

  - 처음에 executeEventQueue/executeCallback순으로 수행되므로

    executeEventQueue를 실행했을 때 callstack이 비었으면 callstack을 처리하고 반복적인 함수실행을 위해 executeEventQueue를 실행시키면서 반복적으로 돌면 다른 함수를 callstack에 담을 수 없기 때문에 setTimeout을 사용하여 이벤트 루프로 던져주었다 

  - 이벤트루프가 비어도 함수를 계속 반복적으로 실행시켜주기 위해 setTimeout함수로 계속함수를 비동기적으로 실행시켰다

  - 10초마다 함수를 부르면서 시간값을 업데이트해줬고 5초가 지나면 프로그램을 종료하도록 하였다.



## 비동기 정리

- 자바스크립트의 함수 실행 방식  : 하나의 함수가 실행되면 이 함수의 실행이 끝날 때까지는 다른 어떤 작업도 중간에 끼어들지못한다.
- 자바스크립트 엔진 : V8(memory heap/call stack)

- callstack이란?
  - 자바스크립트에서 우리가 어떤 부분을 실행하고 있는 지 기록하는 데이터 구조
  - js는 단일 호출 스택 사용
  - 단일 호출 스택을 사용하면 스택이 하나의 일만 처리할 수 있기 때문에 만약 그 함수가 복잡한 연산을 수행한다고 하면 다른 함수가 실행x
  - 이런 단점을 해결하기 위해 비동기 콜백을 사용
- Event Queue
  - js의 런타임 환경의 이벤트 큐는 처리할 메세지 목록과 실행할 콜백함수들의 리스트들이다
  - ex) DOM이벤트/http요청/setTimeout같은 비동기 함수는 Web API를 호출하며 콜백함수를 콜백 큐에 밀어 넣는다
  - 만약 setTimeout을 실행하면 호출스택에서 한 번 실행된 후에 web api에 의해 이벤트큐에 등록된다.
  - setTimeout의 delay를 0으로 주더라도 0초 보다 더 걸리는 이유는 콜 스택에서 모든 프레임이 실행될 때까지 기다려야하기 때문이다.
- Event Loop
  - 자바스크립트의 메인 쓰레드로 싱글쓰레드이다
  - 이벤트 루프는 태스크 큐에 새로운 함수가 들어올 때까지 대기

![undefined](https://cdn.filestackcontent.com/28uVaQ7sRq6LRmU89ptG)

![img](https://t1.daumcdn.net/cfile/tistory/99A7234F5C321A7F2B)

1. 이벤트 발생
2. 비동기 함수가 있으면 web api를 호출하며  web api는 콜백함수를 이벤트큐에  밀어넣는다
3. 이벤트 큐는 대기하다가 스택이 비는 시점에 이벤트 루프를 돌리게 됨
4. 이벤트 루프의 기본역할은 큐와스택 두 부분을 지켜보다가 스택이 비는 시점에 콜백을 처리해주는것ㄴ